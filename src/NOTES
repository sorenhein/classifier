Find the bug that causes throws.

PeakStats: Not global, but passed in.
log the category (train or sensor).
Output csv.

Log measure in peak as part of annotate.

Give out the whole PeakList, don't copy into PeakTime?
Store tme in PeakList as well.
Call peakList peaks.

2018-09-15
----------
Possible flow:

- tentatively accepted (small and together)
- interesting (small but alone)
- in limbo (medium)
- tentatively rejected (large)
- early (any size)

- Run K means as is, maybe with more dispersed starting points
- Accepted clusters
  - At least 3 entries that also have measure +
  - At least 80% have measure +
  - Put the + as tentatively accepted
  - Put those with measure > 4 as tentatively rejected
  - Put the others as in limbo
- Rejected clusters
  - At least 3 entries > 4
  - At least 80% have such measure
  - Put these as tentatively rejected
  - Put those 1 < measure < 4 as in limbo
  - Put those < 1 as interesting
- All peaks in first 400 samples (0.2 s) go in a special list


Starting with the interesting ones

- Extract some key periodicity parameters
  - Cluster neighbors (same parameters as single peaks, but two
    together now in the distance measure), hoping to find a strong
    signal for the bogeys.  Might be two clusters or even more.
    - tentatively accepted bogeys
  - For the tentative singles, look for neighbor peaks together with 
    which they would fit a bogey cluster?
    - Look everywhere except in rejected.  Early only if it makes
      quantitative sense (how?)
  - Drop remaining singles except at the beginning and end
  

2018-09-14
----------
We often get the 2nd of maxima above the line.  sensor34, 180956, #2.

Maybe transients can be reduced with filter padding as in filtfilt.

Do we need to reduce positive minima?  Negative maxima?

Eliminate clusters based on unusual single-parameter values?


2018-09-02
----------
* Improve the recognition (currently 1072 / 1778 = 60.3%)

* Add separate timers for pre-align and align

* Clean up driver.cpp

2018-07-17
----------
* Some _N and _R trains are almost impossible to separate
  - ICE4_DEU_28 is probably symmetric, in fact?
  - ICE2_DEU_48 ditto?
  - ICE1_old_CHE_56 ditto? [delete?]
  - ICE4_DEU_28 and ICET_DEU_28 have extremely similar ratios

* In doc, make the comments from Train axles.xlsx

* Files to finish:
  SynthTrain cpp and h
  driver.cpp

Visual          OK
mingw           OK
gcc
Mac gcc
Mac clang
Linux

Overall algorithm
-----------------

* Check against laser measurements!
* Output a diagram with the wagons suggested
* throw/catch with error codes (like Build)
* filtfilt padding, how?
* Make independent of sample rate (other than Butterworth?)
* Move to less padding in SegQuiet back
* Implement displacement algorithms
  - Our integration
  - Some kind of scalar product
  - Estimate parameters of the flanks?  What kind of function?
  - Also add timers
* Float (Accel) to double everywhere
* Simpson integration?
