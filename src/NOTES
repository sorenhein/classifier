* Hopefully we get the exact right clusters already?!
  short 2N
  medium N inter
  large N intra

A cluster should also have a median?
Good intervals tend to be centered around the median

* If we have
  - 4 gaps: Two ought to combine into a category (short, medium, large).
    Which ones?  Try to make the counts even 2N:N:N.
  - 5 gaps: Ditto 3+1+1, 2+2+1, 2+1+2, 1+2+2
  - 6 gaps: More partitions

* Label S, M, L

* Work in until we get to one of SLS, SMS, MSL, LSM from both sides
  Work out until we get to the first car end beyond the end
  Make a Levenshteyn string for this train with minimal length,
  so round up to 4n+3.

* Go through actual string from the actual start to end (starting
  inside the completed string).
  Fix all single and double errors:
  - Interval overlap: A high M should be a low L etc.
    (Single letter change)
  - Exactly two shorts could become a single short, especially if
    one really is on on the low end (short range has a median +/-
    sdev, so something outside would be good)
  - SLS: Expect MSLS...
    SLS-MLS might be split into SLS-MSLS
    SLS-MLM is too messed up



Repeat:

* Grow outwards using the clusters, can kill spurious peaks
* Fill in missing peaks (single or double) based on L+R gaps

* Look at 3D short-intra-short clusters (at most 3 or so)

* Refine the filled-in peaks from this

* Match car patterns to trains, only a few possibilities

* Run linear regression for each option

* Pick best train, speed, offset

* Derive disturbance and metric for this
  Compare to actual
  Derive q factor


